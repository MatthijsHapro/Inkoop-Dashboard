<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Inkoop Dashboard â€“ Permalink</title>
<link rel="stylesheet" href="styles.css" />
</head>
<script>
document.addEventListener('DOMContentLoaded', function(){

  async function callHsApi(payload) {
    const ENDPOINT = 'https://<JOUW-SERVERLESS-URL>/api/hs'; // TODO: echte URL of laat expres ongeldig om demo te zien
    try {
      const r = await fetch(ENDPOINT, {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(payload)
      });
      if (!r.ok) throw new Error('HTTP ' + r.status);
      return await r.json();
    } catch (e) {
      // DEMO fallback zodat UI altijd iets toont
      const txt = (payload.description || '').toLowerCase();
      const guess = txt.includes('scharnier') ? '83021000'
                 : txt.includes('zit') || txt.includes('swing') ? '95069990'
                 : txt.includes('rvs') || txt.includes('stainless') ? '73269098'
                 : txt.includes('aluminium') ? '76169990'
                 : '39269097';
      return {
        origin: payload.origin || 'CN',
        candidates: [{
          hs_code: guess,
          title: 'Indicatieve match (demo)',
          duty: null,
          reason: 'Demo-modus: ruwe keyword-match (vervang ENDPOINT door je serverless URL).',
          links: {
            a2m: `https://www.google.com/search?q=site%3Atrade.ec.europa.eu+${guess}`,
            nl:  `https://tarief.douane.nl/arctictariff-public-web/Tariff?preferredLanguage=nl&taricCode=${guess}`
          }
        }]
      };
    }
  }

  function renderHS(data){
    const box = document.getElementById('hsResults');
    if (!data || !data.candidates || !data.candidates.length) {
      box.innerHTML = '<div class="small">Geen match. Probeer specifieker (materiaal, functie, set/onderdeel, afmetingen).</div>';
      return;
    }
    box.innerHTML = data.candidates.map(c => `
      <div class="card" style="margin:0 0 10px 0">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
          <div><strong>${c.hs_code || 'â€”'}</strong> â€” ${c.title || ''}</div>
          <div>${c.duty != null ? `<strong>${c.duty}% invoerrecht</strong>` : `<span class="small">tarief: n.v.t.</span>`}</div>
        </div>
        <div class="small" style="margin-top:6px">${c.reason || ''}</div>
        <div class="small" style="margin-top:8px">
          ðŸ”— Verifieer:
          <a href="https://trade.ec.europa.eu/access-to-markets/en/home" target="_blank">Access2Markets</a> Â·
          <a href="https://tarief.douane.nl/" target="_blank">NL Gebruikstarief</a>
          ${c.links?.a2m ? ` Â· <a href="${c.links.a2m}" target="_blank">A2M zoeklink</a>` : ''}
          ${c.links?.nl ? ` Â· <a href="${c.links.nl}" target="_blank">NL tarieflink</a>` : ''}
        </div>
      </div>
    `).join('');
  }

  const btn = document.getElementById('hsSubmit');
  btn?.addEventListener('click', async function(){
    const payload = {
      description: (document.getElementById('hsDesc')?.value || '').trim(),
      material: (document.getElementById('hsMaterial')?.value || '').trim(),
      use: (document.getElementById('hsUse')?.value || '').trim(),
      origin: (document.getElementById('hsOrigin')?.value || 'CN').toUpperCase()
    };
    const data = await callHsApi(payload);
    renderHS(data);
  });

});
</script>
<body>
  <div class="wrap">
    <h1>Dagelijkse Prijzen â€“ Inkoop Dashboard</h1>
    <div class="sub">
      Permalink dashboard. <span class="sep">|</span> Laatst bijgewerkt: <strong id="lastUpdated">â€”</strong>
    </div>

    <div class="tabs">
      <button class="tab active" data-tab="containers-cn">Containerprijzen China</button>
      <button class="tab" data-tab="containers-in">Containerprijzen India</button>
      <button class="tab" data-tab="metals">Metalen</button>
      <button class="tab" data-tab="plastics">Plastics</button>
      <button class="tab" data-tab="energy">Energie</button>
      <button class="tab" data-tab="hs-ai">HS-code AI</button>
    </div>

    <!-- Containerprijzen China (USD) -->
    <section class="card" data-panel="containers-cn">
      <div class="grid">
        <div>
          <div class="row" data-series="CN_20ft" data-unit="USD"><div class="label">20 ft (CIF China â†’ Rotterdam)</div><div><span class="value">$ 1.250</span><span class="delta up">+2%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="CN_40ft" data-unit="USD"><div class="label">40 ft</div><div><span class="value">$ 1.650</span><span class="delta down">-1%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="CN_40HC" data-unit="USD"><div class="label">40 ft HC</div><div><span class="value">$ 1.850</span><span class="delta up">+4%</span> <span class="refdate">Î” vs â€”</span></div></div>
        </div>
        <div class="note">
          <strong>Highlights</strong><br>
          â€¢ Capaciteit krap in preâ€‘holiday weken.<br>
          â€¢ Licht hogere tarieven op AziÃ« â†’ EU hoofdtrade.
        </div>
      </div>
      <div class="chart-wrap" id="chart-cn">
        <div class="chart-title">Trend (1 maand): <span id="chartTitleCN">â€”</span></div>
        <canvas id="canvas-cn" width="1100" height="340"></canvas>
      </div>
    </section>

    <!-- Containerprijzen India (EUR) -->
    <section class="card" data-panel="containers-in" hidden>
      <div class="grid">
        <div>
          <div class="row" data-series="IN_20ft" data-unit="EUR"><div class="label">20 ft (CIF India â†’ Rotterdam)</div><div><span class="value">â‚¬ 1.200</span><span class="delta muted">Â±0%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="IN_40ft" data-unit="EUR"><div class="label">40 ft</div><div><span class="value">â‚¬ 1.580</span><span class="delta up">+1%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="IN_40HC" data-unit="EUR"><div class="label">40 ft HC</div><div><span class="value">â‚¬ 1.780</span><span class="delta up">+2%</span> <span class="refdate">Î” vs â€”</span></div></div>
        </div>
        <div class="note">
          <strong>Highlights</strong><br>
          â€¢ Indicatieve waarden in EUR; spreads t.o.v. China blijven beperkt.<br>
          â€¢ Seizoensinvloed en equipmentbalans spelen mee.
        </div>
      </div>
      <div class="chart-wrap" id="chart-in">
        <div class="chart-title">Trend (1 maand): <span id="chartTitleIN">â€”</span></div>
        <canvas id="canvas-in" width="1100" height="340"></canvas>
      </div>
    </section>

    <!-- Metalen -->
    <section class="card" data-panel="metals" hidden>
      <div class="grid">
        <div>
          <div class="row" data-series="Copper" data-unit="USD/t"><div class="label">Koper (LME 3M)</div><div><span class="value">$ 10.900/t</span><span class="delta up">+0,5%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="Aluminium" data-unit="USD/t"><div class="label">Aluminium (LME 3M)</div><div><span class="value">$ 2.380/t</span><span class="delta down">-0,2%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="Nickel" data-unit="USD/t"><div class="label">Nikkel (LME 3M)</div><div><span class="value">$ 17.600/t</span><span class="delta up">+0,8%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="Stainless" data-unit="USD/t"><div class="label">RVS (Stainless Steel, indicatief)</div><div><span class="value">$ 2.650/t</span><span class="delta muted">Â±0%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="Iron" data-unit="USD/t"><div class="label">IJzer (Iron ore/indicatief)</div><div><span class="value">$ 115/t</span><span class="delta down">-0,4%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="HRC" data-unit="USD/t"><div class="label">HRC Staal (indicatief)</div><div><span class="value">$ 530/t</span><span class="delta muted">Â±0%</span> <span class="refdate">Î” vs â€”</span></div></div>
        </div>
        <div class="note">
          <strong>Highlights</strong><br>
          â€¢ Koper hoger ondanks sterkere dollar.<br>
          â€¢ RVS & HRC volgen nikkel/energie en regionale vraag.<br>
          â€¢ IJzererts gevoelig voor Chinees staalnieuws.
        </div>
      </div>
      <div class="chart-wrap" id="chart-metals">
        <div class="chart-title">Trend (1 maand): <span id="chartTitleMetals">â€”</span></div>
        <canvas id="canvas-metals" width="1100" height="340"></canvas>
      </div>
    </section>

    <!-- Plastics -->
    <section class="card" data-panel="plastics" hidden>
      <div class="grid">
        <div>
          <div class="row" data-series="PP" data-unit="EUR/t"><div class="label">PP (homo, EU)</div><div><span class="value">â‚¬ 1.120/t</span><span class="delta down">-â‚¬ 15</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="HDPE" data-unit="EUR/t"><div class="label">HDPE (EU)</div><div><span class="value">â‚¬ 1.050/t</span><span class="delta muted">Â±0</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="PVC" data-unit="EUR/t"><div class="label">PVC (EU)</div><div><span class="value">â‚¬ 930/t</span><span class="delta down">-â‚¬ 10</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="ABS" data-unit="EUR/t"><div class="label">ABS (EU)</div><div><span class="value">â‚¬ 1.530/t</span><span class="delta up">+â‚¬ 20</span> <span class="refdate">Î” vs â€”</span></div></div>
        </div>
        <div class="note">
          <strong>Highlights</strong><br>
          â€¢ Contract vs. spot blijft uiteenlopen.<br>
          â€¢ Monomeren, energie en importspreads sturen prijsrichting.
        </div>
      </div>
      <div class="chart-wrap" id="chart-plastics">
        <div class="chart-title">Trend (1 maand): <span id="chartTitlePlastics">â€”</span></div>
        <canvas id="canvas-plastics" width="1100" height="340"></canvas>
      </div>
    </section>

    <!-- Energy -->
    <section class="card" data-panel="energy" hidden>
      <div class="grid">
        <div>
          <div class="row" data-series="Brent" data-unit="USD/bbl"><div class="label">Brent (frontâ€‘month)</div><div><span class="value">$ 65,1/bbl</span><span class="delta up">+0,6%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="TTF" data-unit="EUR/MWh"><div class="label">TTF Gas (front)</div><div><span class="value">â‚¬ 31,3/MWh</span><span class="delta down">-1,1%</span> <span class="refdate">Î” vs â€”</span></div></div>
          <div class="row" data-series="Coal" data-unit="USD/t"><div class="label">ICE Coal (Rotterdam)</div><div><span class="value">$ 117/t</span><span class="delta muted">Â±0%</span> <span class="refdate">Î” vs â€”</span></div></div>
        </div>
        <div class="note">
          <strong>Highlights</strong><br>
          â€¢ Olie licht hoger; gas kalm door voorraden.<br>
          â€¢ Kolen stabiel; powerprijzen volgen brandstoffen & EUA.
        </div>
      </div>
      <div class="chart-wrap" id="chart-energy">
        <div class="chart-title">Trend (1 maand): <span id="chartTitleEnergy">â€”</span></div>
        <canvas id="canvas-energy" width="1100" height="340"></canvas>
      </div>
    </section>
    <section class="card" data-panel="hs-ai" hidden>
  <h2>HS-code Zoeker (AI)</h2>
  <p class="small">Vul een duidelijke omschrijving in (materiaal, functie, set/part, afmeting).</p>

  <textarea id="hsDesc" class="input" rows="4"
    placeholder="Bijv. 'Plastic schommelzitje (PE) met metalen ketting, set voor kinderspeeltoestel'"></textarea>

  <div style="display:flex; gap:8px; margin-top:8px">
    <input id="hsMaterial" class="input" placeholder="Materiaal (optioneel)" />
    <input id="hsUse" class="input" placeholder="Gebruik/functie (optioneel)" />
  </div>

  <div style="display:flex; gap:8px; margin-top:8px">
    <input id="hsOrigin" class="input" placeholder="Land van oorsprong (bv. CN, IN)" style="max-width:160px" />
    <input id="hsDest" class="input" value="EU" disabled style="max-width:120px" />
  </div>

  <button id="hsSubmit" class="btn" style="margin-top:10px">ðŸ”Ž Vind HS-code</button>
  <div id="hsResults" style="margin-top:12px"></div>
  <p class="small" style="margin-top:10px">Resultaten zijn indicatief. Verifieer altijd via Access2Markets of NL Gebruikstarief.</p>
</section>

  </div>

  <script src="app.js"></script>

</html>
